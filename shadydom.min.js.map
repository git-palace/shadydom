{"version":3,"sources":["env.js"],"names":["settings","window","ShadyDOM","hasNativeShadowDOM","Boolean","Element","prototype","attachShadow","Node","getRootNode","desc","Object","getOwnPropertyDescriptor","hasDescriptors","configurable","get","hasNerfedDescriptors","inUse","force","isShadyRoot","obj","__localName","p","matches","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","element","selector","call","copyOwnProperty","name","source","target","pd","defineProperty","extend","n$","getOwnPropertyNames","i","n","length","extendAll","sources","mixin","setPrototypeOf","proto","__proto__","patchPrototype","getPrototypeOf","hasOwnProperty","patchProto","create","__sourceProto","__patchProto","promish","Promise","resolve","twiddle","document","createTextNode","content","then","cb","observer","MutationObserver","disconnect","observe","characterData","textContent","customElements$1","customElements","flushList","scheduled","flushCount","flushMax","enqueue","callback","flush","push","shift","isFlushedMaxed","Error","list","AsyncObserver","_scheduled","addedNodes","removedNodes","callbacks","Set","mutations","takeRecords","forEach","observeChildren","node","__shady","add","_callback","_observer","_node","unobserveChildren","handle","delete","size","filterMutations","targetRootNode","map","mutation","mutationInScope","nodes","Array","from","filter","value","m","nativeAppendChild","appendChild","nativeInsertBefore","insertBefore","nativeRemoveChild","removeChild","nativeSetAttribute","setAttribute","nativeRemoveAttribute","removeAttribute","nativeCloneNode","cloneNode","nativeImportNode","Document","importNode","nativeAddEventListener","addEventListener","nativeRemoveEventListener","removeEventListener","nativeMethods","freeze","newSplice","index","removed","addedCount","EDIT_LEAVE","EDIT_UPDATE","EDIT_ADD","EDIT_DELETE","ArraySplice","calcEditDistances","current","currentStart","currentEnd","old","oldStart","oldEnd","rowCount","columnCount","distances","j","equals","north","west","spliceOperationsFromEditDistances","edits","northWest","min","reverse","calcSplices","prefixCount","suffixCount","splice","minLength","Math","sharedPrefix","sharedSuffix","ops","undefined","splices","oldIndex","searchLength","index1","index2","count","calculateSplices","previous","currentValue","previousValue","escapeAttrRegExp","escapeDataRegExp","escapeReplace","c","escapeAttr","s","replace","escapeData","makeSet","arr","set","voidElements","plaintextParents","getOuterHTML","parentNode","composed","nodeType","ELEMENT_NODE","tagName","localName","attrs","attributes","attr","getInnerHTML","TEXT_NODE","data","COMMENT_NODE","console","error","c$","childNodes","l","child","nodeWalker","createTreeWalker","NodeFilter","SHOW_ALL","elementWalker","SHOW_ELEMENT","currentNode","firstChild","lastChild","previousSibling","nextSibling","parentElement","firstElementChild","lastElementChild","previousElementSibling","nextElementSibling","children","innerHTML","nodeValue","textWalker","SHOW_TEXT","nextNode","nativeTree","getProperty","prop","hasProperty","recordInsertBefore","container","ref_node","DOCUMENT_FRAGMENT_NODE","linkNode","resetTo","ps","ns","recordRemoveChild","recordChildNodes","addNode","ownerRoot","ownerShadyRootForNode","ipAdded","__noInsertionPoint","_skipUpdateInsertionPoints","_maybeAddInsertionPoint","handled","_maybeDistribute","shadyRoot","removeNode","logicalParent","distributed","maybeDistributeParent","removedDistributed","_removeDistributedChildren","addedInsertionPoint","getInsertionPointTag","update","_removeOwnerShadyRoot","_scheduleObserver","addedNode","removedNode","schedule","removeNodeFromParent","parent","_hasCachedOwnerRoot","__ownerShadyRoot","root","documentElement","contains","insertionPointTag","fragContent","querySelector","wrappedContent","hasContent","needsDist","_nodeNeedsDistribution","added","querySelectorAll","np","na","hasInsertionPoint","hostNeedsDist","ip$","_insertionPoints","insertionPoint","_contains","dc$","assignedNodes","flatten","firstComposedNode","isFinalDestination","clearNode","distributeAttributeChange","query","matcher","halter","_queryElements","elements","_queryElement","result","nativeActiveElementDescriptor","getDocumentActiveElement","activeElementForNode","active","isShadyRoot$$1","host","activeRoot","activeElementDescriptor","renderRootNode","render","setAttribute$1","ShadyCSS","ownerDocument","setElementClass","removeAttribute$1","insertBefore$1","removeChild$1","nativeParent","cloneNode$1","deep","nc","NormalizedEvent","Event","inType","params","e","createEvent","initEvent","bubbles","cancelable","Distributor","distributePool","collectPool","pool","dirtyRoots","p$","distributeInsertionPoint","assignedSlot","prevAssignedNodes","clearAssignedSlots","needsSlotChange","anyDistributed","matchesInsertionPoint","_prevAssignedSlot","distributeNodeInto","children$$1","setDistributedNodesOnInsertionPoint","_fireSlotChange","slot","savePrevious","slotName","getAttribute","trim","distributedNodes","isInsertionPoint","d$","dispatchEvent","ShadyRoot","frag","createDocumentFragment","ShadyFragmentMixin","_init","ShadyMixin","shadowRoot","_renderPending","_hasRendered","_distributor","_getRenderRoot","_rendererForHost","_render","updateInsertionPoints","distribute","compose","forceRender","i$","__insertionPoints","getInsertionPoints","insertionPoints","_composeTree","_updateChildNodes","_composeNode","distributedNode","d","next","DocumentFragment","Mixins","Fragment","alwaysComposed","blur","focus","focusin","focusout","click","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","wheel","beforeinput","input","keydown","keyup","compositionstart","compositionupdate","compositionend","touchstart","touchend","touchmove","touchcancel","pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture","dragstart","drag","dragenter","dragleave","dragover","drop","dragend","DOMActivate","DOMFocusIn","DOMFocusOut","keypress","pathComposer","startNode","composedPath","startRoot","retarget","refNode","path","refNodePath","ancestor","lastRoot","rootIdx","indexOf","EventMixin","__patched","isTrusted","__composed","type","__composedPath","__target","currentTarget","relatedTarget","__relatedTarget","__relatedTargetComposedPath","stopPropagation","__propagationStopped","stopImmediatePropagation","__immediatePropagationStopped","mixinComposedFlag","Base","klazz","options","event","nonBubblingEventsToRetarget","fireHandlers","phase","hs","__handlers","fn","retargetNonBubblingEvent","AT_TARGET","lastFiredRoot","addEventListener$1","optionsOrCapture","capture","once","passive","__eventWrappers","wrapperFn","eventPhase","BUBBLING_PHASE","bubble","removeEventListener$1","idx","activateFocusEventOverrides","ev","PatchedEvent","PatchedCustomEvent","CustomEvent","PatchedMouseEvent","MouseEvent","generateSimpleDescriptor","assignedSlotDesc","NodeMixin","replaceChild","defineProperties","tc","cn","join","text","isConnected","TextMixin","FragmentMixin","childrenDescriptor","domParser","DOMParser","insertDOMFrom","innerHTMLDescriptor","doc","parseFromString","head","body","SlotMixin","ElementMixin","className","HTMLElementMixin","ActiveElementMixin","activeElement","UnderActiveElementMixin","_activeElement","Text","Slot","HTMLElement","mixin$$1","ifExists","__nativeProps","sd","warn","md","getComposedInnerHTML","getComposedChildNodes","patch","he","nativeHTMLElement","HTMLSlotElement"],"mappings":"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","file":"shadydom.min.js","sourcesContent":["(function () {\n'use strict';\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nlet settings = window.ShadyDOM || {};\n\nsettings.hasNativeShadowDOM = Boolean(Element.prototype.attachShadow && Node.prototype.getRootNode);\n\nlet desc = Object.getOwnPropertyDescriptor(Node.prototype, 'firstChild');\n\nsettings.hasDescriptors = Boolean(desc && desc.configurable && desc.get);\nsettings.hasNerfedDescriptors = Boolean(desc && !settings.hasDescriptors);\n\n\nsettings.inUse = settings.force || !settings.hasNativeShadowDOM;\n\n\n\nfunction isShadyRoot(obj) {\n  return Boolean(obj.__localName === 'ShadyRoot');\n}\n\nlet p = Element.prototype;\nlet matches = p.matches || p.matchesSelector ||\n  p.mozMatchesSelector || p.msMatchesSelector ||\n  p.oMatchesSelector || p.webkitMatchesSelector;\n\nfunction matchesSelector(element, selector) {\n  return matches.call(element, selector);\n}\n\nfunction copyOwnProperty(name, source, target) {\n  let pd = Object.getOwnPropertyDescriptor(source, name);\n  if (pd) {\n    Object.defineProperty(target, name, pd);\n  }\n}\n\nfunction extend(target, source) {\n  if (target && source) {\n    let n$ = Object.getOwnPropertyNames(source);\n    for (let i=0, n; (i<n$.length) && (n=n$[i]); i++) {\n      copyOwnProperty(n, source, target);\n    }\n  }\n  return target || source;\n}\n\nfunction extendAll(target, ...sources) {\n  for (let i=0; i < sources.length; i++) {\n    extend(target, sources[i]);\n  }\n  return target;\n}\n\nfunction mixin(target, source) {\n  for (var i in source) {\n    target[i] = source[i];\n  }\n  return target;\n}\n\nlet setPrototypeOf = Object.setPrototypeOf || function(obj, proto) {\n  obj.__proto__ = proto;\n  return obj;\n};\n\nfunction patchPrototype(obj, mixin) {\n  let proto = Object.getPrototypeOf(obj);\n  if (!proto.hasOwnProperty('__patchProto')) {\n    let patchProto = Object.create(proto);\n    patchProto.__sourceProto = proto;\n    extend(patchProto, mixin);\n    proto.__patchProto = patchProto;\n  }\n  setPrototypeOf(obj, proto.__patchProto);\n}\n\n\n\n\n\n// TODO(sorvell): actually rely on a real Promise polyfill...\nlet promish;\nif (window.Promise) {\n  promish = Promise.resolve();\n} else {\n  let twiddle = document.createTextNode('');\n  let content = 0;\n  promish = {\n    then(cb) {\n      // To preserve timing with Promise microtasks\n      // we create a new observer for every callback.\n      let observer = new MutationObserver(function() {\n        observer.disconnect();\n        cb();\n      });\n      observer.observe(twiddle, {characterData: true});\n      twiddle.textContent = content++;\n    }\n  };\n}\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// render enqueuer/flusher\nlet customElements$1 = window.customElements;\nlet flushList = [];\nlet scheduled;\nlet flushCount = 0;\nlet flushMax = 100;\nfunction enqueue(callback) {\n  if (!scheduled) {\n    scheduled = true;\n    promish.then(flush);\n  }\n  flushList.push(callback);\n}\n\nfunction flush() {\n  scheduled = false;\n  flushCount++;\n  while (flushList.length) {\n    flushList.shift()();\n  }\n  if (customElements$1 && customElements$1.flush) {\n    customElements$1.flush();\n  }\n  // continue flushing after elements are upgraded...\n  const isFlushedMaxed = (flushCount > flushMax);\n  if (flushList.length && !isFlushedMaxed) {\n      flush();\n  }\n  flushCount = 0;\n  if (isFlushedMaxed) {\n    throw new Error('Loop detected in ShadyDOM distribution, aborting.')\n  }\n}\n\nflush.list = flushList;\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nclass AsyncObserver {\n\n  constructor() {\n    this._scheduled = false;\n    this.addedNodes = [];\n    this.removedNodes = [];\n    this.callbacks = new Set();\n  }\n\n  schedule() {\n    if (!this._scheduled) {\n      this._scheduled = true;\n      promish.then(() => {\n        this.flush();\n      });\n    }\n  }\n\n  flush() {\n    if (this._scheduled) {\n      this._scheduled = false;\n      let mutations = this.takeRecords();\n      if (mutations.length) {\n        this.callbacks.forEach(function(cb) {\n          cb(mutations);\n        });\n      }\n    }\n  }\n\n  takeRecords() {\n    if (this.addedNodes.length || this.removedNodes.length) {\n      let mutations = [{\n        addedNodes: this.addedNodes,\n        removedNodes: this.removedNodes\n      }];\n      this.addedNodes = [];\n      this.removedNodes = [];\n      return mutations;\n    }\n    return [];\n  }\n\n}\n\n// TODO(sorvell): consider instead polyfilling MutationObserver\n// directly so that users do not have to fork their code.\n// Supporting the entire api may be challenging: e.g. filtering out\n// removed nodes in the wrong scope and seeing non-distributing\n// subtree child mutations.\nlet observeChildren = function(node, callback) {\n  //utils.common.patchNode(node);\n  if (!node.__shady.observer) {\n    node.__shady.observer = new AsyncObserver();\n  }\n  node.__shady.observer.callbacks.add(callback);\n  let observer = node.__shady.observer;\n  return {\n    _callback: callback,\n    _observer: observer,\n    _node: node,\n    takeRecords() {\n      return observer.takeRecords()\n    }\n  };\n};\n\nlet unobserveChildren = function(handle) {\n  let observer = handle && handle._observer;\n  if (observer) {\n    observer.callbacks.delete(handle._callback);\n    if (!observer.callbacks.size) {\n      handle._node.__shady.observer = null;\n    }\n  }\n};\n\nfunction filterMutations(mutations, target) {\n  const targetRootNode = target.getRootNode();\n  return mutations.map(function(mutation) {\n    const mutationInScope = (targetRootNode === mutation.target.getRootNode());\n    if (mutationInScope && mutation.addedNodes) {\n      let nodes = Array.from(mutation.addedNodes).filter(function(n) {\n        return (targetRootNode === n.getRootNode());\n      });\n      if (nodes.length) {\n        mutation = Object.create(mutation);\n        Object.defineProperty(mutation, 'addedNodes', {\n          value: nodes,\n          configurable: true\n        });\n        return mutation;\n      }\n    } else if (mutationInScope) {\n      return mutation;\n    }\n  }).filter(function(m) { return m});\n}\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nlet nativeAppendChild = Element.prototype.appendChild;\nlet appendChild = nativeAppendChild;\n\nlet nativeInsertBefore = Element.prototype.insertBefore;\nlet insertBefore = nativeInsertBefore;\n\nlet nativeRemoveChild = Element.prototype.removeChild;\nlet removeChild = nativeRemoveChild;\n\nlet nativeSetAttribute = Element.prototype.setAttribute;\nlet setAttribute = nativeSetAttribute;\n\nlet nativeRemoveAttribute = Element.prototype.removeAttribute;\nlet removeAttribute = nativeRemoveAttribute;\n\nlet nativeCloneNode = Element.prototype.cloneNode;\nlet cloneNode = nativeCloneNode;\n\nlet nativeImportNode = Document.prototype.importNode;\nlet importNode = nativeImportNode;\n\nlet nativeAddEventListener = Element.prototype.addEventListener;\nlet addEventListener = nativeAddEventListener;\n\nlet nativeRemoveEventListener = Element.prototype.removeEventListener;\nlet removeEventListener = nativeRemoveEventListener;\n\n\nvar nativeMethods = Object.freeze({\n\tappendChild: appendChild,\n\tinsertBefore: insertBefore,\n\tremoveChild: removeChild,\n\tsetAttribute: setAttribute,\n\tremoveAttribute: removeAttribute,\n\tcloneNode: cloneNode,\n\timportNode: importNode,\n\taddEventListener: addEventListener,\n\tremoveEventListener: removeEventListener\n});\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nfunction newSplice(index, removed, addedCount) {\n  return {\n    index: index,\n    removed: removed,\n    addedCount: addedCount\n  };\n}\n\nconst EDIT_LEAVE = 0;\nconst EDIT_UPDATE = 1;\nconst EDIT_ADD = 2;\nconst EDIT_DELETE = 3;\n\nlet ArraySplice = {\n\n  // Note: This function is *based* on the computation of the Levenshtein\n  // \"edit\" distance. The one change is that \"updates\" are treated as two\n  // edits - not one. With Array splices, an update is really a delete\n  // followed by an add. By retaining this, we optimize for \"keeping\" the\n  // maximum array items in the original array. For example:\n  //\n  //   'xxxx123' -> '123yyyy'\n  //\n  // With 1-edit updates, the shortest path would be just to update all seven\n  // characters. With 2-edit updates, we delete 4, leave 3, and add 4. This\n  // leaves the substring '123' intact.\n  calcEditDistances(current, currentStart, currentEnd,\n                              old, oldStart, oldEnd) {\n    // \"Deletion\" columns\n    let rowCount = oldEnd - oldStart + 1;\n    let columnCount = currentEnd - currentStart + 1;\n    let distances = new Array(rowCount);\n\n    // \"Addition\" rows. Initialize null column.\n    for (let i = 0; i < rowCount; i++) {\n      distances[i] = new Array(columnCount);\n      distances[i][0] = i;\n    }\n\n    // Initialize null row\n    for (let j = 0; j < columnCount; j++)\n      distances[0][j] = j;\n\n    for (let i = 1; i < rowCount; i++) {\n      for (let j = 1; j < columnCount; j++) {\n        if (this.equals(current[currentStart + j - 1], old[oldStart + i - 1]))\n          distances[i][j] = distances[i - 1][j - 1];\n        else {\n          let north = distances[i - 1][j] + 1;\n          let west = distances[i][j - 1] + 1;\n          distances[i][j] = north < west ? north : west;\n        }\n      }\n    }\n\n    return distances;\n  },\n\n  // This starts at the final weight, and walks \"backward\" by finding\n  // the minimum previous weight recursively until the origin of the weight\n  // matrix.\n  spliceOperationsFromEditDistances(distances) {\n    let i = distances.length - 1;\n    let j = distances[0].length - 1;\n    let current = distances[i][j];\n    let edits = [];\n    while (i > 0 || j > 0) {\n      if (i == 0) {\n        edits.push(EDIT_ADD);\n        j--;\n        continue;\n      }\n      if (j == 0) {\n        edits.push(EDIT_DELETE);\n        i--;\n        continue;\n      }\n      let northWest = distances[i - 1][j - 1];\n      let west = distances[i - 1][j];\n      let north = distances[i][j - 1];\n\n      let min;\n      if (west < north)\n        min = west < northWest ? west : northWest;\n      else\n        min = north < northWest ? north : northWest;\n\n      if (min == northWest) {\n        if (northWest == current) {\n          edits.push(EDIT_LEAVE);\n        } else {\n          edits.push(EDIT_UPDATE);\n          current = northWest;\n        }\n        i--;\n        j--;\n      } else if (min == west) {\n        edits.push(EDIT_DELETE);\n        i--;\n        current = west;\n      } else {\n        edits.push(EDIT_ADD);\n        j--;\n        current = north;\n      }\n    }\n\n    edits.reverse();\n    return edits;\n  },\n\n  /**\n   * Splice Projection functions:\n   *\n   * A splice map is a representation of how a previous array of items\n   * was transformed into a new array of items. Conceptually it is a list of\n   * tuples of\n   *\n   *   <index, removed, addedCount>\n   *\n   * which are kept in ascending index order of. The tuple represents that at\n   * the |index|, |removed| sequence of items were removed, and counting forward\n   * from |index|, |addedCount| items were added.\n   */\n\n  /**\n   * Lacking individual splice mutation information, the minimal set of\n   * splices can be synthesized given the previous state and final state of an\n   * array. The basic approach is to calculate the edit distance matrix and\n   * choose the shortest path through it.\n   *\n   * Complexity: O(l * p)\n   *   l: The length of the current array\n   *   p: The length of the old array\n   */\n  calcSplices(current, currentStart, currentEnd,\n                        old, oldStart, oldEnd) {\n    let prefixCount = 0;\n    let suffixCount = 0;\n    let splice;\n\n    let minLength = Math.min(currentEnd - currentStart, oldEnd - oldStart);\n    if (currentStart == 0 && oldStart == 0)\n      prefixCount = this.sharedPrefix(current, old, minLength);\n\n    if (currentEnd == current.length && oldEnd == old.length)\n      suffixCount = this.sharedSuffix(current, old, minLength - prefixCount);\n\n    currentStart += prefixCount;\n    oldStart += prefixCount;\n    currentEnd -= suffixCount;\n    oldEnd -= suffixCount;\n\n    if (currentEnd - currentStart == 0 && oldEnd - oldStart == 0)\n      return [];\n\n    if (currentStart == currentEnd) {\n      splice = newSplice(currentStart, [], 0);\n      while (oldStart < oldEnd)\n        splice.removed.push(old[oldStart++]);\n\n      return [ splice ];\n    } else if (oldStart == oldEnd)\n      return [ newSplice(currentStart, [], currentEnd - currentStart) ];\n\n    let ops = this.spliceOperationsFromEditDistances(\n        this.calcEditDistances(current, currentStart, currentEnd,\n                               old, oldStart, oldEnd));\n\n    splice = undefined;\n    let splices = [];\n    let index = currentStart;\n    let oldIndex = oldStart;\n    for (let i = 0; i < ops.length; i++) {\n      switch(ops[i]) {\n        case EDIT_LEAVE:\n          if (splice) {\n            splices.push(splice);\n            splice = undefined;\n          }\n\n          index++;\n          oldIndex++;\n          break;\n        case EDIT_UPDATE:\n          if (!splice)\n            splice = newSplice(index, [], 0);\n\n          splice.addedCount++;\n          index++;\n\n          splice.removed.push(old[oldIndex]);\n          oldIndex++;\n          break;\n        case EDIT_ADD:\n          if (!splice)\n            splice = newSplice(index, [], 0);\n\n          splice.addedCount++;\n          index++;\n          break;\n        case EDIT_DELETE:\n          if (!splice)\n            splice = newSplice(index, [], 0);\n\n          splice.removed.push(old[oldIndex]);\n          oldIndex++;\n          break;\n      }\n    }\n\n    if (splice) {\n      splices.push(splice);\n    }\n    return splices;\n  },\n\n  sharedPrefix(current, old, searchLength) {\n    for (let i = 0; i < searchLength; i++)\n      if (!this.equals(current[i], old[i]))\n        return i;\n    return searchLength;\n  },\n\n  sharedSuffix(current, old, searchLength) {\n    let index1 = current.length;\n    let index2 = old.length;\n    let count = 0;\n    while (count < searchLength && this.equals(current[--index1], old[--index2]))\n      count++;\n\n    return count;\n  },\n\n  calculateSplices(current, previous) {\n    return this.calcSplices(current, 0, current.length, previous, 0,\n                            previous.length);\n  },\n\n  equals(currentValue, previousValue) {\n    return currentValue === previousValue;\n  }\n\n};\n\nlet calculateSplices = (current, previous) =>\n  ArraySplice.calculateSplices(current, previous);\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// Cribbed from ShadowDOM polyfill\n// https://github.com/webcomponents/webcomponentsjs/blob/master/src/ShadowDOM/wrappers/HTMLElement.js#L28\n/////////////////////////////////////////////////////////////////////////////\n// innerHTML and outerHTML\n\n// http://www.whatwg.org/specs/web-apps/current-work/multipage/the-end.html#escapingString\nlet escapeAttrRegExp = /[&\\u00A0\"]/g;\nlet escapeDataRegExp = /[&\\u00A0<>]/g;\n\nfunction escapeReplace(c) {\n  switch (c) {\n    case '&':\n      return '&amp;';\n    case '<':\n      return '&lt;';\n    case '>':\n      return '&gt;';\n    case '\"':\n      return '&quot;';\n    case '\\u00A0':\n      return '&nbsp;';\n  }\n}\n\nfunction escapeAttr(s) {\n  return s.replace(escapeAttrRegExp, escapeReplace);\n}\n\nfunction escapeData(s) {\n  return s.replace(escapeDataRegExp, escapeReplace);\n}\n\nfunction makeSet(arr) {\n  let set = {};\n  for (let i = 0; i < arr.length; i++) {\n    set[arr[i]] = true;\n  }\n  return set;\n}\n\n// http://www.whatwg.org/specs/web-apps/current-work/#void-elements\nlet voidElements = makeSet([\n  'area',\n  'base',\n  'br',\n  'col',\n  'command',\n  'embed',\n  'hr',\n  'img',\n  'input',\n  'keygen',\n  'link',\n  'meta',\n  'param',\n  'source',\n  'track',\n  'wbr'\n]);\n\nlet plaintextParents = makeSet([\n  'style',\n  'script',\n  'xmp',\n  'iframe',\n  'noembed',\n  'noframes',\n  'plaintext',\n  'noscript'\n]);\n\nfunction getOuterHTML(node, parentNode, composed) {\n  switch (node.nodeType) {\n    case Node.ELEMENT_NODE: {\n      let tagName = node.localName;\n      let s = '<' + tagName;\n      let attrs = node.attributes;\n      for (let i = 0, attr; (attr = attrs[i]); i++) {\n        s += ' ' + attr.name + '=\"' + escapeAttr(attr.value) + '\"';\n      }\n      s += '>';\n      if (voidElements[tagName]) {\n        return s;\n      }\n      return s + getInnerHTML(node, composed) + '</' + tagName + '>';\n    }\n    case Node.TEXT_NODE: {\n      let data = node.data;\n      if (parentNode && plaintextParents[parentNode.localName]) {\n        return data;\n      }\n      return escapeData(data);\n    }\n    case Node.COMMENT_NODE: {\n      return '<!--' + node.data + '-->';\n    }\n    default: {\n      window.console.error(node);\n      throw new Error('not implemented');\n    }\n  }\n}\n\nfunction getInnerHTML(node, composed) {\n  if (node.localName === 'template') {\n    node = node.content;\n  }\n  let s = '';\n  let c$ = composed ? composed(node) : node.childNodes;\n  for (let i=0, l=c$.length, child; (i<l) && (child=c$[i]); i++) {\n    s += getOuterHTML(child, node, composed);\n  }\n  return s;\n}\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nlet nodeWalker = document.createTreeWalker(document, NodeFilter.SHOW_ALL,\n  null, false);\n\nlet elementWalker = document.createTreeWalker(document, NodeFilter.SHOW_ELEMENT,\n  null, false);\n\nfunction parentNode(node) {\n  nodeWalker.currentNode = node;\n  return nodeWalker.parentNode();\n}\n\nfunction firstChild(node) {\n  nodeWalker.currentNode = node;\n  return nodeWalker.firstChild();\n}\n\nfunction lastChild(node) {\n  nodeWalker.currentNode = node;\n  return nodeWalker.lastChild();\n}\n\nfunction previousSibling(node) {\n  nodeWalker.currentNode = node;\n  return nodeWalker.previousSibling();\n}\n\nfunction nextSibling(node) {\n  nodeWalker.currentNode = node;\n  return nodeWalker.nextSibling();\n}\n\nfunction childNodes(node) {\n  let nodes = [];\n  nodeWalker.currentNode = node;\n  let n = nodeWalker.firstChild();\n  while (n) {\n    nodes.push(n);\n    n = nodeWalker.nextSibling();\n  }\n  return nodes;\n}\n\nfunction parentElement(node) {\n  elementWalker.currentNode = node;\n  return elementWalker.parentNode();\n}\n\nfunction firstElementChild(node) {\n  elementWalker.currentNode = node;\n  return elementWalker.firstChild();\n}\n\nfunction lastElementChild(node) {\n  elementWalker.currentNode = node;\n  return elementWalker.lastChild();\n}\n\nfunction previousElementSibling(node) {\n  elementWalker.currentNode = node;\n  return elementWalker.previousSibling();\n}\n\nfunction nextElementSibling(node) {\n  elementWalker.currentNode = node;\n  return elementWalker.nextSibling();\n}\n\nfunction children(node) {\n  let nodes = [];\n  elementWalker.currentNode = node;\n  let n = elementWalker.firstChild();\n  while (n) {\n    nodes.push(n);\n    n = elementWalker.nextSibling();\n  }\n  return nodes;\n}\n\nfunction innerHTML(node) {\n  return getInnerHTML(node, (n) => childNodes(n));\n}\n\nfunction textContent(node) {\n  if (node.nodeType !== Node.ELEMENT_NODE) {\n    return node.nodeValue;\n  }\n  let textWalker = document.createTreeWalker(node, NodeFilter.SHOW_TEXT,\n    null, false);\n  let content = '', n;\n  while ( (n = textWalker.nextNode()) ) {\n    // TODO(sorvell): can't use textContent since we patch it on Node.prototype!\n    // However, should probably patch it only on element.\n    content += n.nodeValue;\n  }\n  return content;\n}\n\nvar nativeTree = Object.freeze({\n\tparentNode: parentNode,\n\tfirstChild: firstChild,\n\tlastChild: lastChild,\n\tpreviousSibling: previousSibling,\n\tnextSibling: nextSibling,\n\tchildNodes: childNodes,\n\tparentElement: parentElement,\n\tfirstElementChild: firstElementChild,\n\tlastElementChild: lastElementChild,\n\tpreviousElementSibling: previousElementSibling,\n\tnextElementSibling: nextElementSibling,\n\tchildren: children,\n\tinnerHTML: innerHTML,\n\ttextContent: textContent\n});\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nfunction getProperty(node, prop) {\n  return node.__shady && node.__shady[prop];\n}\n\nfunction hasProperty(node, prop) {\n  return getProperty(node, prop) !== undefined;\n}\n\nfunction recordInsertBefore(node, container, ref_node) {\n  container.__shady = container.__shady || {};\n  if (hasProperty(container, 'firstChild')) {\n    container.__shady.childNodes = null;\n  }\n  // handle document fragments\n  if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n    let c$ = node.childNodes;\n    for (let i=0; i < c$.length; i++) {\n      linkNode(c$[i], container, ref_node);\n    }\n    // cleanup logical dom in doc fragment.\n    node.__shady = node.__shady || {};\n    let resetTo = hasProperty(node, 'firstChild') ? null : undefined;\n    node.__shady.firstChild = node.__shady.lastChild = resetTo;\n    node.__shady.childNodes = resetTo;\n  } else {\n    linkNode(node, container, ref_node);\n  }\n}\n\nfunction linkNode(node, container, ref_node) {\n  ref_node = ref_node || null;\n  node.__shady = node.__shady || {};\n  container.__shady = container.__shady || {};\n  if (ref_node) {\n    ref_node.__shady = ref_node.__shady || {};\n  }\n  // update ref_node.previousSibling <-> node\n  node.__shady.previousSibling = ref_node ? ref_node.__shady.previousSibling :\n    container.lastChild;\n  let ps = node.__shady.previousSibling;\n  if (ps && ps.__shady) {\n    ps.__shady.nextSibling = node;\n  }\n  // update node <-> ref_node\n  let ns = node.__shady.nextSibling = ref_node;\n  if (ns && ns.__shady) {\n    ns.__shady.previousSibling = node;\n  }\n  // update node <-> container\n  node.__shady.parentNode = container;\n  if (ref_node) {\n    if (ref_node === container.__shady.firstChild) {\n      container.__shady.firstChild = node;\n    }\n  } else {\n    container.__shady.lastChild = node;\n    if (!container.__shady.firstChild) {\n      container.__shady.firstChild = node;\n    }\n  }\n  // remove caching of childNodes\n  container.__shady.childNodes = null;\n}\n\nfunction recordRemoveChild(node, container) {\n  node.__shady = node.__shady || {};\n  container.__shady = container.__shady || {};\n  if (node === container.__shady.firstChild) {\n    container.__shady.firstChild = node.__shady.nextSibling;\n  }\n  if (node === container.__shady.lastChild) {\n    container.__shady.lastChild = node.__shady.previousSibling;\n  }\n  let p = node.__shady.previousSibling;\n  let n = node.__shady.nextSibling;\n  if (p) {\n    p.__shady = p.__shady || {};\n    p.__shady.nextSibling = n;\n  }\n  if (n) {\n    n.__shady = n.__shady || {};\n    n.__shady.previousSibling = p;\n  }\n  // When an element is removed, logical data is no longer tracked.\n  // Explicitly set `undefined` here to indicate this. This is disginguished\n  // from `null` which is set if info is null.\n  node.__shady.parentNode = node.__shady.previousSibling =\n    node.__shady.nextSibling = undefined;\n  if (hasProperty(container, 'childNodes')) {\n    // remove caching of childNodes\n    container.__shady.childNodes = null;\n  }\n}\n\nlet recordChildNodes = function(node) {\n  if (!hasProperty(node, 'firstChild')) {\n    node.__shady = node.__shady || {};\n    node.__shady.firstChild = firstChild(node);\n    node.__shady.lastChild = lastChild(node);\n    let c$ = node.__shady.childNodes = childNodes(node);\n    for (let i=0, n; (i<c$.length) && (n=c$[i]); i++) {\n      n.__shady = n.__shady || {};\n      n.__shady.parentNode = node;\n      n.__shady.nextSibling = c$[i+1] || null;\n      n.__shady.previousSibling = c$[i-1] || null;\n    }\n  }\n};\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// Try to add node. Record logical info, track insertion points, perform\n// distribution iff needed. Return true if the add is handled.\nfunction addNode(container, node, ref_node) {\n  let ownerRoot = ownerShadyRootForNode(container);\n  let ipAdded;\n  if (ownerRoot) {\n    // optimization: special insertion point tracking\n    // TODO(sorvell): verify that the renderPending check here should not be needed.\n    // if (node.__noInsertionPoint && !ownerRoot._renderPending) {\n    if (node.__noInsertionPoint) {\n      ownerRoot._skipUpdateInsertionPoints = true;\n    }\n    // note: we always need to see if an insertion point is added\n    // since this saves logical tree info; however, invalidation state\n    // needs\n    ipAdded = _maybeAddInsertionPoint(node, container, ownerRoot);\n    // invalidate insertion points IFF not already invalid!\n    if (ipAdded) {\n      ownerRoot._skipUpdateInsertionPoints = false;\n    }\n  }\n  if (hasProperty(container, 'firstChild')) {\n    recordInsertBefore(node, container, ref_node);\n  }\n  // if not distributing and not adding to host, do a fast path addition\n  // TODO(sorvell): revisit flow since `ipAdded` needed here if\n  // node is a fragment that has a patched QSA.\n  let handled = _maybeDistribute(node, container, ownerRoot, ipAdded) ||\n    container.shadyRoot;\n  return handled;\n}\n\n// Try to remove node: update logical info and perform distribution iff\n// needed. Return true if the removal has been handled.\n// note that it's possible for both the node's host and its parent\n// to require distribution... both cases are handled here.\nfunction removeNode(node) {\n  // important that we want to do this only if the node has a logical parent\n  let logicalParent = hasProperty(node, 'parentNode') &&\n    getProperty(node, 'parentNode');\n  let distributed;\n  let ownerRoot = ownerShadyRootForNode(node);\n  if (logicalParent || ownerRoot) {\n    // distribute node's parent iff needed\n    distributed = maybeDistributeParent(node);\n    if (logicalParent) {\n      recordRemoveChild(node, logicalParent);\n    }\n    // remove node from root and distribute it iff needed\n    let removedDistributed = ownerRoot &&\n      _removeDistributedChildren(ownerRoot, node);\n    let addedInsertionPoint = (logicalParent && ownerRoot &&\n      logicalParent.localName === ownerRoot.getInsertionPointTag());\n    if (removedDistributed || addedInsertionPoint) {\n      ownerRoot._skipUpdateInsertionPoints = false;\n      ownerRoot.update();\n    }\n  }\n  _removeOwnerShadyRoot(node);\n  return distributed;\n}\n\n\nfunction _scheduleObserver(node, addedNode, removedNode) {\n  let observer = node.__shady && node.__shady.observer;\n  if (observer) {\n    if (addedNode) {\n      observer.addedNodes.push(addedNode);\n    }\n    if (removedNode) {\n      observer.removedNodes.push(removedNode);\n    }\n    observer.schedule();\n  }\n}\n\nfunction removeNodeFromParent(node, parent) {\n  if (parent) {\n    _scheduleObserver(parent, null, node);\n    return removeNode(node);\n  } else {\n    _removeOwnerShadyRoot(node);\n  }\n}\n\nfunction _hasCachedOwnerRoot(node) {\n  return Boolean(node.__ownerShadyRoot !== undefined);\n}\n\nfunction getRootNode(node) {\n  if (!node || !node.nodeType) {\n    return;\n  }\n  let root = node.__ownerShadyRoot;\n  if (root === undefined) {\n    if (isShadyRoot(node)) {\n      root = node;\n    } else {\n      let parent = node.parentNode;\n      root = parent ? getRootNode(parent) : node;\n    }\n    // memo-ize result for performance but only memo-ize\n    // result if node is in the document. This avoids a problem where a root\n    // can be cached while an element is inside a fragment.\n    // If this happens and we cache the result, the value can become stale\n    // because for perf we avoid processing the subtree of added fragments.\n    if (document.documentElement.contains(node)) {\n      node.__ownerShadyRoot = root;\n    }\n  }\n  return root;\n}\n\nfunction ownerShadyRootForNode(node) {\n  let root = getRootNode(node);\n  if (isShadyRoot(root)) {\n    return root;\n  }\n}\n\nfunction _maybeDistribute(node, container, ownerRoot, ipAdded) {\n  // TODO(sorvell): technically we should check non-fragment nodes for\n  // <content> children but since this case is assumed to be exceedingly\n  // rare, we avoid the cost and will address with some specific api\n  // when the need arises.  For now, the user must call\n  // distributeContent(true), which updates insertion points manually\n  // and forces distribution.\n  let insertionPointTag = ownerRoot && ownerRoot.getInsertionPointTag() || '';\n  let fragContent = (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) &&\n    !node.__noInsertionPoint &&\n    insertionPointTag && node.querySelector(insertionPointTag);\n  let wrappedContent = fragContent &&\n    (fragContent.parentNode.nodeType !==\n    Node.DOCUMENT_FRAGMENT_NODE);\n  let hasContent = fragContent || (node.localName === insertionPointTag);\n  // There are 3 possible cases where a distribution may need to occur:\n  // 1. <content> being inserted (the host of the shady root where\n  //    content is inserted needs distribution)\n  // 2. children being inserted into parent with a shady root (parent\n  //    needs distribution)\n  // 3. container is an insertionPoint\n  if (hasContent || (container.localName === insertionPointTag) || ipAdded) {\n    if (ownerRoot) {\n      // note, insertion point list update is handled after node\n      // mutations are complete\n      ownerRoot.update();\n    }\n  }\n  let needsDist = _nodeNeedsDistribution(container);\n  if (needsDist) {\n    container.shadyRoot.update();\n  }\n  // Return true when distribution will fully handle the composition\n  // Note that if a content was being inserted that was wrapped by a node,\n  // and the parent does not need distribution, return false to allow\n  // the nodes to be added directly, after which children may be\n  // distributed and composed into the wrapping node(s)\n  return needsDist || (hasContent && !wrappedContent);\n}\n\n/* note: parent argument is required since node may have an out\nof date parent at this point; returns true if a <content> is being added */\nfunction _maybeAddInsertionPoint(node, parent, root) {\n  let added;\n  let insertionPointTag = root.getInsertionPointTag();\n  if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE &&\n    !node.__noInsertionPoint) {\n    let c$ = node.querySelectorAll(insertionPointTag);\n    for (let i=0, n, np, na; (i<c$.length) && (n=c$[i]); i++) {\n      np = n.parentNode;\n      // don't allow node's parent to be fragment itself\n      if (np === node) {\n        np = parent;\n      }\n      na = _maybeAddInsertionPoint(n, np, root);\n      added = added || na;\n    }\n  } else if (node.localName === insertionPointTag) {\n    recordChildNodes(parent);\n    recordChildNodes(node);\n    added = true;\n  }\n  return added;\n}\n\nfunction _nodeNeedsDistribution(node) {\n  return node && node.shadyRoot &&\n    node.shadyRoot.hasInsertionPoint();\n}\n\nfunction _removeDistributedChildren(root, container) {\n  let hostNeedsDist;\n  let ip$ = root._insertionPoints;\n  for (let i=0; i<ip$.length; i++) {\n    let insertionPoint = ip$[i];\n    if (_contains(container, insertionPoint)) {\n      let dc$ = insertionPoint.assignedNodes({flatten: true});\n      for (let j=0; j<dc$.length; j++) {\n        hostNeedsDist = true;\n        let node = dc$[j];\n        let parent = parentNode(node);\n        if (parent) {\n          removeChild.call(parent, node);\n        }\n      }\n    }\n  }\n  return hostNeedsDist;\n}\n\nfunction _contains(container, node) {\n  while (node) {\n    if (node == container) {\n      return true;\n    }\n    node = node.parentNode;\n  }\n}\n\nfunction _removeOwnerShadyRoot(node) {\n  // optimization: only reset the tree if node is actually in a root\n  if (_hasCachedOwnerRoot(node)) {\n    let c$ = node.childNodes;\n    for (let i=0, l=c$.length, n; (i<l) && (n=c$[i]); i++) {\n      _removeOwnerShadyRoot(n);\n    }\n  }\n  node.__ownerShadyRoot = undefined;\n}\n\n// TODO(sorvell): This will fail if distribution that affects this\n// question is pending; this is expected to be exceedingly rare, but if\n// the issue comes up, we can force a flush in this case.\nfunction firstComposedNode(insertionPoint) {\n  let n$ = insertionPoint.assignedNodes({flatten: true});\n  let root = getRootNode(insertionPoint);\n  for (let i=0, l=n$.length, n; (i<l) && (n=n$[i]); i++) {\n    // means that we're composed to this spot.\n    if (root.isFinalDestination(insertionPoint, n)) {\n      return n;\n    }\n  }\n}\n\nfunction clearNode(node) {\n  while (node.firstChild) {\n    node.removeChild(node.firstChild);\n  }\n}\n\nfunction maybeDistributeParent(node) {\n  let parent = node.parentNode;\n  if (_nodeNeedsDistribution(parent)) {\n    parent.shadyRoot.update();\n    return true;\n  }\n}\n\nfunction distributeAttributeChange(node, name) {\n  if (name === 'slot') {\n    maybeDistributeParent(node);\n  } else if (node.localName === 'slot' && name === 'name') {\n    let root = ownerShadyRootForNode(node);\n    if (root) {\n      root.update();\n    }\n  }\n}\n\n// NOTE: `query` is used primarily for ShadyDOM's querySelector impl,\n// but it's also generally useful to recurse through the element tree\n// and is used by Polymer's styling system.\nfunction query(node, matcher, halter) {\n  let list = [];\n  _queryElements(node.childNodes, matcher,\n    halter, list);\n  return list;\n}\n\nfunction _queryElements(elements, matcher, halter, list) {\n  for (let i=0, l=elements.length, c; (i<l) && (c=elements[i]); i++) {\n    if (c.nodeType === Node.ELEMENT_NODE &&\n        _queryElement(c, matcher, halter, list)) {\n      return true;\n    }\n  }\n}\n\nfunction _queryElement(node, matcher, halter, list) {\n  let result = matcher(node);\n  if (result) {\n    list.push(node);\n  }\n  if (halter && halter(result)) {\n    return result;\n  }\n  _queryElements(node.childNodes, matcher,\n    halter, list);\n}\n\nlet nativeActiveElementDescriptor = Object.getOwnPropertyDescriptor(\n  Document.prototype, 'activeElement');\nfunction getDocumentActiveElement() {\n  if (nativeActiveElementDescriptor && nativeActiveElementDescriptor.get) {\n    return nativeActiveElementDescriptor.get.call(document);\n  }\n}\n\nfunction activeElementForNode(node) {\n  let active = getDocumentActiveElement();\n  if (!active) {\n    return null;\n  }\n  let isShadyRoot$$1 = !!(isShadyRoot(node));\n  if (node !== document) {\n    // If this node isn't a document or shady root, then it doesn't have\n    // an active element.\n    if (!isShadyRoot$$1) {\n      return null;\n    }\n    // If this shady root's host is the active element or the active\n    // element is not a descendant of the host (in the composed tree),\n    // then it doesn't have an active element.\n    if (node.host === active ||\n        !node.host.contains(active)) {\n      return null;\n    }\n  }\n  // This node is either the document or a shady root of which the active\n  // element is a (composed) descendant of its host; iterate upwards to\n  // find the active element's most shallow host within it.\n  let activeRoot = ownerShadyRootForNode(active);\n  while (activeRoot && activeRoot !== node) {\n    active = activeRoot.host;\n    activeRoot = ownerShadyRootForNode(active);\n  }\n  if (node === document) {\n    // This node is the document, so activeRoot should be null.\n    return activeRoot ? null : active;\n  } else {\n    // This node is a non-document shady root, and it should be\n    // activeRoot.\n    return activeRoot === node ? active : null;\n  }\n}\n\nlet activeElementDescriptor = {\n  get() {\n    return activeElementForNode(this);\n  }\n};\n\nfunction renderRootNode(element) {\n  var root = element.getRootNode();\n  if (isShadyRoot(root)) {\n    root.render();\n  }\n}\n\nfunction setAttribute$1(node, attr, value) {\n  // avoid scoping elements in non-main document to avoid template documents\n  if (window.ShadyCSS && attr === 'class' && node.ownerDocument === document) {\n    window.ShadyCSS.setElementClass(node, value);\n  } else {\n    setAttribute.call(node, attr, value);\n    distributeAttributeChange(node, attr);\n  }\n}\n\nfunction removeAttribute$1(node, attr) {\n  removeAttribute.call(node, attr);\n  distributeAttributeChange(node, name);\n}\n\n// cases in which we may not be able to just do standard native call\n// 1. container has a shadyRoot (needsDistribution IFF the shadyRoot\n// has an insertion point)\n// 2. container is a shadyRoot (don't distribute, instead set\n// container to container.host.\n// 3. node is <content> (host of container needs distribution)\nfunction insertBefore$1(parent, node, ref_node) {\n  if (ref_node) {\n    let p = getProperty(ref_node, 'parentNode');\n    if (p !== undefined && p !== parent) {\n      throw Error('The ref_node to be inserted before is not a child ' +\n        'of this node');\n    }\n  }\n  // remove node from its current position iff it's in a tree.\n  if (node.nodeType !== Node.DOCUMENT_FRAGMENT_NODE) {\n    let parent = getProperty(node, 'parentNode');\n    removeNodeFromParent(node, parent);\n  }\n  if (!addNode(parent, node, ref_node)) {\n    if (ref_node) {\n      // if ref_node is an insertion point replace with first distributed node\n      let root = ownerShadyRootForNode(ref_node);\n      if (root) {\n        ref_node = ref_node.localName === root.getInsertionPointTag() ?\n          firstComposedNode(ref_node) : ref_node;\n      }\n    }\n    // if adding to a shadyRoot, add to host instead\n    let container = isShadyRoot(parent) ?\n      parent.host : parent;\n    if (ref_node) {\n      insertBefore.call(container, node, ref_node);\n    } else {\n      appendChild.call(container, node);\n    }\n  }\n  _scheduleObserver(parent, node);\n  return node;\n}\n\n/**\n  Removes the given `node` from the element's `lightChildren`.\n  This method also performs dom composition.\n*/\nfunction removeChild$1(parent, node) {\n  if (node.parentNode !== parent) {\n    throw Error('The node to be removed is not a child of this node: ' +\n      node);\n  }\n  if (!removeNode(node)) {\n    // if removing from a shadyRoot, remove form host instead\n    let container = isShadyRoot(parent) ?\n      parent.host :\n      parent;\n    // not guaranteed to physically be in container; e.g.\n    // undistributed nodes.\n    let nativeParent = parentNode(node);\n    if (container === nativeParent) {\n      removeChild.call(container, node);\n    }\n  }\n  _scheduleObserver(parent, null, node);\n  return node;\n}\n\nfunction cloneNode$1(node, deep) {\n  if (node.localName == 'template') {\n    return cloneNode.call(node, deep);\n  } else {\n    let n = cloneNode.call(node, false);\n    if (deep) {\n      let c$ = node.childNodes;\n      for (let i=0, nc; i < c$.length; i++) {\n        nc = c$[i].cloneNode(true);\n        n.appendChild(nc);\n      }\n    }\n    return n;\n  }\n}\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// NOTE: normalize event contruction where necessary (IE11)\nlet NormalizedEvent = typeof Event === 'function' ? Event :\n  function(inType, params) {\n    params = params || {};\n    var e = document.createEvent('Event');\n    e.initEvent(inType, Boolean(params.bubbles), Boolean(params.cancelable));\n    return e;\n  };\n\nvar Distributor = class {\n\n  constructor(root) {\n    this.root = root;\n    this.insertionPointTag = 'slot';\n  }\n\n  getInsertionPoints() {\n    return this.root.querySelectorAll(this.insertionPointTag);\n  }\n\n  hasInsertionPoint() {\n    return Boolean(this.root._insertionPoints &&\n      this.root._insertionPoints.length);\n  }\n\n  isInsertionPoint(node) {\n    return node.localName && node.localName == this.insertionPointTag;\n  }\n\n  distribute() {\n    if (this.hasInsertionPoint()) {\n      return this.distributePool(this.root, this.collectPool());\n    }\n    return [];\n  }\n\n  // Gather the pool of nodes that should be distributed. We will combine\n  // these with the \"content root\" to arrive at the composed tree.\n  collectPool() {\n    let host = this.root.host;\n    let pool=[], i=0;\n    for (let n=host.firstChild; n; n=n.nextSibling) {\n      pool[i++] = n;\n    }\n    return pool;\n  }\n\n  // perform \"logical\" distribution; note, no actual dom is moved here,\n  // instead elements are distributed into storage\n  // array where applicable.\n  distributePool(node, pool) {\n    let dirtyRoots = [];\n    let p$ = this.root._insertionPoints;\n    for (let i=0, l=p$.length, p; (i<l) && (p=p$[i]); i++) {\n      this.distributeInsertionPoint(p, pool);\n      // provoke redistribution on insertion point parents\n      // must do this on all candidate hosts since distribution in this\n      // scope invalidates their distribution.\n      // only get logical parent.\n      let parent = p.parentNode;\n      if (parent && parent.shadyRoot &&\n          this.hasInsertionPoint(parent.shadyRoot)) {\n        dirtyRoots.push(parent.shadyRoot);\n      }\n    }\n    for (let i=0; i < pool.length; i++) {\n      let p = pool[i];\n      if (p) {\n        p.__shady = p.__shady || {};\n        p.__shady.assignedSlot = undefined;\n        // remove undistributed elements from physical dom.\n        let parent = parentNode(p);\n        if (parent) {\n          removeChild.call(parent, p);\n        }\n      }\n    }\n    return dirtyRoots;\n  }\n\n  distributeInsertionPoint(insertionPoint, pool) {\n    let prevAssignedNodes = insertionPoint.__shady.assignedNodes;\n    if (prevAssignedNodes) {\n      this.clearAssignedSlots(insertionPoint, true);\n    }\n    insertionPoint.__shady.assignedNodes = [];\n    let needsSlotChange = false;\n    // distribute nodes from the pool that this selector matches\n    let anyDistributed = false;\n    for (let i=0, l=pool.length, node; i < l; i++) {\n      node=pool[i];\n      // skip nodes that were already used\n      if (!node) {\n        continue;\n      }\n      // distribute this node if it matches\n      if (this.matchesInsertionPoint(node, insertionPoint)) {\n        if (node.__shady._prevAssignedSlot != insertionPoint) {\n          needsSlotChange = true;\n        }\n        this.distributeNodeInto(node, insertionPoint);\n        // remove this node from the pool\n        pool[i] = undefined;\n        // since at least one node matched, we won't need fallback content\n        anyDistributed = true;\n      }\n    }\n    // Fallback content if nothing was distributed here\n    if (!anyDistributed) {\n      let children$$1 = insertionPoint.childNodes;\n      for (let j = 0, node; j < children$$1.length; j++) {\n        node = children$$1[j];\n        if (node.__shady._prevAssignedSlot != insertionPoint) {\n          needsSlotChange = true;\n        }\n        this.distributeNodeInto(node, insertionPoint);\n      }\n    }\n    // we're already dirty if a node was newly added to the slot\n    // and we're also dirty if the assigned count decreased.\n    if (prevAssignedNodes) {\n      // TODO(sorvell): the tracking of previously assigned slots\n      // could instead by done with a Set and then we could\n      // avoid needing to iterate here to clear the info.\n      for (let i=0; i < prevAssignedNodes.length; i++) {\n        prevAssignedNodes[i].__shady._prevAssignedSlot = null;\n      }\n      if (insertionPoint.__shady.assignedNodes.length < prevAssignedNodes.length) {\n        needsSlotChange = true;\n      }\n    }\n    this.setDistributedNodesOnInsertionPoint(insertionPoint);\n    if (needsSlotChange) {\n      this._fireSlotChange(insertionPoint);\n    }\n  }\n\n  clearAssignedSlots(slot, savePrevious) {\n    let n$ = slot.__shady.assignedNodes;\n    if (n$) {\n      for (let i=0; i < n$.length; i++) {\n        let n = n$[i];\n        if (savePrevious) {\n          n.__shady._prevAssignedSlot = n.__shady.assignedSlot;\n        }\n        // only clear if it was previously set to this slot;\n        // this helps ensure that if the node has otherwise been distributed\n        // ignore it.\n        if (n.__shady.assignedSlot === slot) {\n          n.__shady.assignedSlot = null;\n        }\n      }\n    }\n  }\n\n  matchesInsertionPoint(node, insertionPoint) {\n    let slotName = insertionPoint.getAttribute('name');\n    slotName = slotName ? slotName.trim() : '';\n    let slot = node.getAttribute && node.getAttribute('slot');\n    slot = slot ? slot.trim() : '';\n    return (slot == slotName);\n  }\n\n  distributeNodeInto(child, insertionPoint) {\n    insertionPoint.__shady.assignedNodes.push(child);\n    child.__shady.assignedSlot = insertionPoint;\n  }\n\n  setDistributedNodesOnInsertionPoint(insertionPoint) {\n    let n$ = insertionPoint.__shady.assignedNodes;\n    insertionPoint.__shady.distributedNodes = [];\n    for (let i=0, n; (i<n$.length) && (n=n$[i]) ; i++) {\n      if (this.isInsertionPoint(n)) {\n        let d$ = n.__shady.distributedNodes;\n        if (d$) {\n          for (let j=0; j < d$.length; j++) {\n            insertionPoint.__shady.distributedNodes.push(d$[j]);\n          }\n        }\n      } else {\n        insertionPoint.__shady.distributedNodes.push(n$[i]);\n      }\n    }\n  }\n\n  _fireSlotChange(insertionPoint) {\n    // NOTE: cannot bubble correctly here so not setting bubbles: true\n    // Safari tech preview does not bubble but chrome does\n    // Spec says it bubbles (https://dom.spec.whatwg.org/#mutation-observers)\n    insertionPoint.dispatchEvent(new NormalizedEvent('slotchange'));\n    if (insertionPoint.__shady.assignedSlot) {\n      this._fireSlotChange(insertionPoint.__shady.assignedSlot);\n    }\n  }\n\n  isFinalDestination(insertionPoint) {\n    return !(insertionPoint.__shady.assignedSlot);\n  }\n\n};\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/**\n  Implements a pared down version of ShadowDOM's scoping, which is easy to\n  polyfill across browsers.\n*/\nclass ShadyRoot {\n\n  constructor(host) {\n    if (!host) {\n      throw 'Must provide a host';\n    }\n    // NOTE: this strange construction is necessary because\n    // DocumentFragment cannot be subclassed on older browsers.\n    let frag = document.createDocumentFragment();\n    frag.__proto__ = ShadyFragmentMixin;\n    frag._init(host);\n    return frag;\n  }\n\n}\n\nlet ShadyMixin = {\n\n  _init(host) {\n    // NOTE: set a fake local name so this element can be\n    // distinguished from a DocumentFragment when patching.\n    // FF doesn't allow this to be `localName`\n    this.__localName = 'ShadyRoot';\n    // root <=> host\n    host.shadowRoot = this;\n    this.host = host;\n    // logical dom setup\n    recordChildNodes(host);\n    recordChildNodes(this);\n    // state flags\n    this._renderPending = false;\n    this._hasRendered = false;\n    this._distributor = new Distributor(this);\n    this.update();\n  },\n\n  // async render\n  update() {\n    if (!this._renderPending) {\n      this._renderPending = true;\n      enqueue(() => this.render());\n    }\n  },\n\n  _getRenderRoot() {\n    let root = this._rendererForHost();\n    // TODO(sorvell): actually want the highest dirty root in distribution tree\n    return root ? root._getRenderRoot() : this;\n  },\n\n  // Returns the shadyRoot `this.host` if `this.host`\n  // has children that require distribution.\n  _rendererForHost() {\n    let root = this.host.getRootNode();\n    if (isShadyRoot(root)) {\n      let c$ = this.host.childNodes;\n      for (let i=0, c; i < c$.length; i++) {\n        c = c$[i];\n        if (this._distributor.isInsertionPoint(c)) {\n          return root;\n        }\n      }\n    }\n  },\n\n  render() {\n    if (this._renderPending) {\n      this._getRenderRoot()._render();\n    }\n  },\n\n  _render() {\n    this._renderPending = false;\n    if (!this._skipUpdateInsertionPoints) {\n      this.updateInsertionPoints();\n    } else if (!this._hasRendered) {\n      this._insertionPoints = [];\n    }\n    this._skipUpdateInsertionPoints = false;\n    // TODO(sorvell): can add a first render optimization here\n    // to use if there are no insertion points\n    // 1. clear host node of composed children\n    // 2. appendChild the shadowRoot itself or (more robust) its logical children\n    // NOTE: this didn't seem worth it in perf testing\n    // but not ready to delete this info.\n    // logical\n    this.distribute();\n    // physical\n    this.compose();\n    this._hasRendered = true;\n  },\n\n  forceRender() {\n    this._renderPending = true;\n    this.render();\n  },\n\n  distribute() {\n    let dirtyRoots = this._distributor.distribute();\n    for (let i=0; i<dirtyRoots.length; i++) {\n      dirtyRoots[i]._render();\n    }\n  },\n\n  updateInsertionPoints() {\n    let i$ = this.__insertionPoints;\n    // if any insertion points have been removed, clear their distribution info\n    if (i$) {\n      for (let i=0, c; i < i$.length; i++) {\n        c = i$[i];\n        if (c.getRootNode() !== this) {\n          this._distributor.clearAssignedSlots(c);\n        }\n      }\n    }\n    i$ = this._insertionPoints = this._distributor.getInsertionPoints();\n    // ensure insertionPoints's and their parents have logical dom info.\n    // save logical tree info\n    // a. for shadyRoot\n    // b. for insertion points (fallback)\n    // c. for parents of insertion points\n    for (let i=0, c; i < i$.length; i++) {\n      c = i$[i];\n      c.__shady = c.__shady || {};\n      recordChildNodes(c);\n      recordChildNodes(c.parentNode);\n    }\n  },\n\n  get _insertionPoints() {\n    if (!this.__insertionPoints) {\n      this.updateInsertionPoints();\n    }\n    return this.__insertionPoints || (this.__insertionPoints = []);\n  },\n\n  set _insertionPoints(insertionPoints) {\n    this.__insertionPoints = insertionPoints;\n  },\n\n  hasInsertionPoint() {\n    return this._distributor.hasInsertionPoint();\n  },\n\n  compose() {\n    // compose self\n    // note: it's important to mark this clean before distribution\n    // so that attachment that provokes additional distribution (e.g.\n    // adding something to your parentNode) works\n    this._composeTree();\n    // TODO(sorvell): See fast paths here in Polymer v1\n    // (these seem unnecessary)\n  },\n\n  // Reify dom such that it is at its correct rendering position\n  // based on logical distribution.\n  _composeTree() {\n    this._updateChildNodes(this.host, this._composeNode(this.host));\n    let p$ = this._insertionPoints || [];\n    for (let i=0, l=p$.length, p, parent; (i<l) && (p=p$[i]); i++) {\n      parent = p.parentNode;\n      if ((parent !== this.host) && (parent !== this)) {\n        this._updateChildNodes(parent, this._composeNode(parent));\n      }\n    }\n  },\n\n  // Returns the list of nodes which should be rendered inside `node`.\n  _composeNode(node) {\n    let children$$1 = [];\n    let c$ = (node.shadyRoot || node).childNodes;\n    for (let i = 0; i < c$.length; i++) {\n      let child = c$[i];\n      if (this._distributor.isInsertionPoint(child)) {\n        let distributedNodes = child.__shady.distributedNodes ||\n          (child.__shady.distributedNodes = []);\n        for (let j = 0; j < distributedNodes.length; j++) {\n          let distributedNode = distributedNodes[j];\n          if (this.isFinalDestination(child, distributedNode)) {\n            children$$1.push(distributedNode);\n          }\n        }\n      } else {\n        children$$1.push(child);\n      }\n    }\n    return children$$1;\n  },\n\n  isFinalDestination(insertionPoint, node) {\n    return this._distributor.isFinalDestination(\n      insertionPoint, node);\n  },\n\n  // Ensures that the rendered node list inside `container` is `children`.\n  _updateChildNodes(container, children$$1) {\n    let composed = Array.from(isShadyRoot(container) ?\n      container.childNodes :\n      childNodes(container));\n    let splices = calculateSplices(children$$1, composed);\n    // process removals\n    for (let i=0, d=0, s; (i<splices.length) && (s=splices[i]); i++) {\n      for (let j=0, n; (j < s.removed.length) && (n=s.removed[j]); j++) {\n        // check if the node is still where we expect it is before trying\n        // to remove it; this can happen if we move a node and\n        // then schedule its previous host for distribution resulting in\n        // the node being removed here.\n        if (parentNode(n) === container) {\n          removeChild.call(container, n);\n        }\n        composed.splice(s.index + d, 1);\n      }\n      d -= s.addedCount;\n    }\n    // process adds\n    for (let i=0, s, next; (i<splices.length) && (s=splices[i]); i++) { //eslint-disable-line no-redeclare\n      next = composed[s.index];\n      for (let j=s.index, n; j < s.index + s.addedCount; j++) {\n        n = children$$1[j];\n        insertBefore.call(container, n, next);\n        // TODO(sorvell): is this splice strictly needed?\n        composed.splice(j, 0, n);\n      }\n    }\n  },\n\n  getInsertionPointTag() {\n    return this._distributor.insertionPointTag;\n  }\n\n};\n\nlet ShadyFragmentMixin = Object.create(DocumentFragment.prototype);\nextendAll(ShadyFragmentMixin, ShadyMixin, Mixins.Fragment);\nObject.defineProperty(ShadyFragmentMixin, 'activeElement', activeElementDescriptor);\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// https://github.com/w3c/webcomponents/issues/513#issuecomment-224183937\nlet alwaysComposed = {\n  blur: true,\n  focus: true,\n  focusin: true,\n  focusout: true,\n  click: true,\n  dblclick: true,\n  mousedown: true,\n  mouseenter: true,\n  mouseleave: true,\n  mousemove: true,\n  mouseout: true,\n  mouseover: true,\n  mouseup: true,\n  wheel: true,\n  beforeinput: true,\n  input: true,\n  keydown: true,\n  keyup: true,\n  compositionstart: true,\n  compositionupdate: true,\n  compositionend: true,\n  touchstart: true,\n  touchend: true,\n  touchmove: true,\n  touchcancel: true,\n  pointerover: true,\n  pointerenter: true,\n  pointerdown: true,\n  pointermove: true,\n  pointerup: true,\n  pointercancel: true,\n  pointerout: true,\n  pointerleave: true,\n  gotpointercapture: true,\n  lostpointercapture: true,\n  dragstart: true,\n  drag: true,\n  dragenter: true,\n  dragleave: true,\n  dragover: true,\n  drop: true,\n  dragend: true,\n  DOMActivate: true,\n  DOMFocusIn: true,\n  DOMFocusOut: true,\n  keypress: true\n};\n\nfunction pathComposer(startNode, composed) {\n  let composedPath = [];\n  let current = startNode;\n  let startRoot = startNode === window ? window : startNode.getRootNode();\n  while (current) {\n    composedPath.push(current);\n    if (current.assignedSlot) {\n      current = current.assignedSlot;\n    } else if (current.nodeType === Node.DOCUMENT_FRAGMENT_NODE && current.host && (composed || current !== startRoot)) {\n      current = current.host;\n    } else {\n      current = current.parentNode;\n    }\n  }\n  // event composedPath includes window when startNode's ownerRoot is document\n  if (composedPath[composedPath.length - 1] === document) {\n    composedPath.push(window);\n  }\n  return composedPath;\n}\n\nfunction retarget(refNode, path) {\n  if (!isShadyRoot) {\n    return refNode;\n  }\n  // If ANCESTOR's root is not a shadow root or ANCESTOR's root is BASE's\n  // shadow-including inclusive ancestor, return ANCESTOR.\n  let refNodePath = pathComposer(refNode, true);\n  let p$ = path;\n  for (let i=0, ancestor, lastRoot, root, rootIdx; i < p$.length; i++) {\n    ancestor = p$[i];\n    root = ancestor === window ? window : ancestor.getRootNode();\n    if (root !== lastRoot) {\n      rootIdx = refNodePath.indexOf(root);\n      lastRoot = root;\n    }\n    if (!isShadyRoot(root) || rootIdx > -1) {\n      return ancestor;\n    }\n  }\n}\n\nlet EventMixin = {\n\n  __patched: 5,\n\n  get composed() {\n    if (this.isTrusted && this.__composed === undefined) {\n      this.__composed = alwaysComposed[this.type];\n    }\n    return this.__composed || false;\n  },\n\n  composedPath() {\n    if (!this.__composedPath) {\n      this.__composedPath = pathComposer(this.__target, this.composed);\n    }\n    return this.__composedPath;\n  },\n\n  get target() {\n    return retarget(this.currentTarget, this.composedPath());\n  },\n\n  // http://w3c.github.io/webcomponents/spec/shadow/#event-relatedtarget-retargeting\n  get relatedTarget() {\n    if (!this.__relatedTarget) {\n      return null;\n    }\n    if (!this.__relatedTargetComposedPath) {\n      this.__relatedTargetComposedPath = pathComposer(this.__relatedTarget, true);\n    }\n    // find the deepest node in relatedTarget composed path that is in the same root with the currentTarget\n    return retarget(this.currentTarget, this.__relatedTargetComposedPath);\n  },\n  stopPropagation() {\n    Event.prototype.stopPropagation.call(this);\n    this.__propagationStopped = true;\n  },\n  stopImmediatePropagation() {\n    Event.prototype.stopImmediatePropagation.call(this);\n    this.__immediatePropagationStopped = true;\n    this.__propagationStopped = true;\n  }\n\n};\n\nfunction mixinComposedFlag(Base) {\n  // NOTE: avoiding use of `class` here so that transpiled output does not\n  // try to do `Base.call` with a dom construtor.\n  let klazz = function(type, options) {\n    let event = new Base(type, options);\n    event.__composed = options && Boolean(options.composed);\n    return event;\n  };\n  // put constructor properties on subclass\n  mixin(klazz, Base);\n  klazz.prototype = Base.prototype;\n  return klazz;\n}\n\nlet nonBubblingEventsToRetarget = {\n  focus: true,\n  blur: true\n};\n\nfunction fireHandlers(event, node, phase) {\n  let hs = node.__handlers && node.__handlers[event.type] &&\n    node.__handlers[event.type][phase];\n  if (hs) {\n    for (let i = 0, fn; (fn = hs[i]); i++) {\n      fn.call(node, event);\n      if (event.__immediatePropagationStopped) {\n        return;\n      }\n    }\n  }\n}\n\nfunction retargetNonBubblingEvent(e) {\n  let path = e.composedPath();\n  let node;\n  // override `currentTarget` to let patched `target` calculate correctly\n  Object.defineProperty(e, 'currentTarget', {\n    get: function() {\n      return node;\n    },\n    configurable: true\n  });\n  for (let i = path.length - 1; i >= 0; i--) {\n    node = path[i];\n    // capture phase fires all capture handlers\n    fireHandlers(e, node, 'capture');\n    if (e.__propagationStopped) {\n      return;\n    }\n  }\n\n  // set the event phase to `AT_TARGET` as in spec\n  Object.defineProperty(e, 'eventPhase', {value: Event.AT_TARGET});\n\n  // the event only needs to be fired when owner roots change when iterating the event path\n  // keep track of the last seen owner root\n  let lastFiredRoot;\n  for (let i = 0; i < path.length; i++) {\n    node = path[i];\n    if (i === 0 || (node.shadowRoot && node.shadowRoot === lastFiredRoot)) {\n      fireHandlers(e, node, 'bubble');\n      // don't bother with window, it doesn't have `getRootNode` and will be last in the path anyway\n      if (node !== window) {\n        lastFiredRoot = node.getRootNode();\n      }\n      if (e.__propagationStopped) {\n        return;\n      }\n    }\n  }\n}\n\nfunction addEventListener$1(type, fn, optionsOrCapture) {\n  if (!fn) {\n    return;\n  }\n\n  // The callback `fn` might be used for multiple nodes/events. Since we generate\n  // a wrapper function, we need to keep track of it when we remove the listener.\n  // It's more efficient to store the node/type/options information as Array in\n  // `fn` itself rather than the node (we assume that the same callback is used\n  // for few nodes at most, whereas a node will likely have many event listeners).\n  // NOTE(valdrin) invoking external functions is costly, inline has better perf.\n  let capture, once, passive;\n  if (typeof optionsOrCapture === 'object') {\n    capture = Boolean(optionsOrCapture.capture);\n    once = Boolean(optionsOrCapture.once);\n    passive = Boolean(optionsOrCapture.passive);\n  } else {\n    capture = Boolean(optionsOrCapture);\n    once = false;\n    passive = false;\n  }\n  if (fn.__eventWrappers) {\n    // Stop if the wrapper function has already been created.\n    for (let i = 0; i < fn.__eventWrappers.length; i++) {\n      if (fn.__eventWrappers[i].node === this &&\n          fn.__eventWrappers[i].type === type &&\n          fn.__eventWrappers[i].capture === capture &&\n          fn.__eventWrappers[i].once === once &&\n          fn.__eventWrappers[i].passive === passive) {\n        return;\n      }\n    }\n  } else {\n    fn.__eventWrappers = [];\n  }\n\n  const wrapperFn = function(e) {\n    // Support `once` option.\n    if (once) {\n      this.removeEventListener(type, fn, optionsOrCapture);\n    }\n    if (!e.__target) {\n      e.__target = e.target;\n      e.__relatedTarget = e.relatedTarget;\n      patchPrototype(e, EventMixin);\n    }\n    // There are two critera that should stop events from firing on this node\n    // 1. the event is not composed and the current node is not in the same root as the target\n    // 2. when bubbling, if after retargeting, relatedTarget and target point to the same node\n    if (e.composed || e.composedPath().indexOf(this) > -1) {\n      if (e.eventPhase === Event.BUBBLING_PHASE) {\n        if (e.target === e.relatedTarget) {\n          e.stopImmediatePropagation();\n          return;\n        }\n      }\n      return fn(e);\n    }\n  };\n  // Store the wrapper information.\n  fn.__eventWrappers.push({\n    node: this,\n    type: type,\n    capture: capture,\n    once: once,\n    passive: passive,\n    wrapperFn: wrapperFn\n  });\n\n  if (nonBubblingEventsToRetarget[type]) {\n    this.__handlers = this.__handlers || {};\n    this.__handlers[type] = this.__handlers[type] || {capture: [], bubble: []};\n    this.__handlers[type][capture ? 'capture' : 'bubble'].push(wrapperFn);\n  } else {\n    addEventListener.call(this, type, wrapperFn, optionsOrCapture);\n  }\n}\n\nfunction removeEventListener$1(type, fn, optionsOrCapture) {\n  if (!fn) {\n    return;\n  }\n\n  // NOTE(valdrin) invoking external functions is costly, inline has better perf.\n  let capture, once, passive;\n  if (typeof optionsOrCapture === 'object') {\n    capture = Boolean(optionsOrCapture.capture);\n    once = Boolean(optionsOrCapture.once);\n    passive = Boolean(optionsOrCapture.passive);\n  } else {\n    capture = Boolean(optionsOrCapture);\n    once = false;\n    passive = false;\n  }\n  // Search the wrapped function.\n  let wrapperFn = undefined;\n  if (fn.__eventWrappers) {\n    for (let i = 0; i < fn.__eventWrappers.length; i++) {\n      if (fn.__eventWrappers[i].node === this &&\n          fn.__eventWrappers[i].type === type &&\n          fn.__eventWrappers[i].capture === capture &&\n          fn.__eventWrappers[i].once === once &&\n          fn.__eventWrappers[i].passive === passive) {\n        wrapperFn = fn.__eventWrappers.splice(i, 1)[0].wrapperFn;\n        // Cleanup.\n        if (!fn.__eventWrappers.length) {\n          fn.__eventWrappers = undefined;\n        }\n        break;\n      }\n    }\n  }\n\n  removeEventListener.call(this, type, wrapperFn || fn, optionsOrCapture);\n  if (wrapperFn && nonBubblingEventsToRetarget[type] &&\n      this.__handlers && this.__handlers[type]) {\n    const arr = this.__handlers[type][capture ? 'capture' : 'bubble'];\n    const idx = arr.indexOf(wrapperFn);\n    if (idx > -1) {\n      arr.splice(idx, 1);\n    }\n  }\n}\n\nfunction activateFocusEventOverrides() {\n  for (let ev in nonBubblingEventsToRetarget) {\n    window.addEventListener(ev, function(e) {\n      if (!e.__target) {\n        e.__target = e.target;\n        e.__relatedTarget = e.relatedTarget;\n        patchPrototype(e, EventMixin);\n        retargetNonBubblingEvent(e);\n        e.stopImmediatePropagation();\n      }\n    }, true);\n  }\n}\n\n\nlet PatchedEvent = mixinComposedFlag(Event);\nlet PatchedCustomEvent = mixinComposedFlag(CustomEvent);\nlet PatchedMouseEvent = mixinComposedFlag(MouseEvent);\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// TODO(sorvell): remove when conditional accessor mixin is generalized\n// Safari 9 `className` is not configurable\n// let cn = Object.getOwnPropertyDescriptor(Element.prototype, 'className');\n// if (cn && cn.configurable) {\n//   Object.defineProperty(Element.prototype, 'className', classNameDescriptor);\n// } else {\n//   // on IE `className` is on Element\n//   let h = window.customElements && window.customElements.nativeHTMLElement ||\n//     HTMLElement;\n//   cn = Object.getOwnPropertyDescriptor(h.prototype, 'className');\n//   if (cn && cn.configurable) {\n//     Object.defineProperty(h.prototype, 'className', classNameDescriptor);\n//   }\n// }\n\nfunction generateSimpleDescriptor(prop) {\n  return {\n    get() {\n      let l = getProperty(this, prop);\n      return l !== undefined ? l : nativeTree[prop](this);\n    },\n    configurable: true\n  }\n}\n\nlet assignedSlotDesc = {\n  get() {\n    return getProperty(this, 'assignedSlot') || null;\n  },\n  configurable: true\n};\n\nlet NodeMixin = {\n\n  addEventListener: addEventListener$1,\n\n  removeEventListener: removeEventListener$1,\n\n  getRootNode(options) {\n    return getRootNode(this, options);\n  },\n\n  appendChild(node) {\n    return insertBefore$1(this, node);\n  },\n\n  insertBefore(node, ref_node) {\n    return insertBefore$1(this, node, ref_node);\n  },\n\n  /**\n    Removes the given `node` from the element's `lightChildren`.\n    This method also performs dom composition.\n  */\n  removeChild(node) {\n    return removeChild$1(this, node);\n  },\n\n  replaceChild(node, ref_node) {\n    this.insertBefore(node, ref_node);\n    this.removeChild(ref_node);\n    return node;\n  },\n\n  cloneNode(deep) {\n    return cloneNode$1(this, deep);\n  }\n};\n\nObject.defineProperties(NodeMixin, {\n\n  parentElement: generateSimpleDescriptor('parentElement'),\n\n  parentNode: generateSimpleDescriptor('parentNode'),\n\n  nextSibling: generateSimpleDescriptor('nextSibling'),\n\n  previousSibling: generateSimpleDescriptor('previousSibling'),\n\n  childNodes: {\n    get() {\n      if (hasProperty(this, 'firstChild')) {\n        if (!this.__shady.childNodes) {\n          this.__shady.childNodes = [];\n          for (let n=this.firstChild; n; n=n.nextSibling) {\n            this.__shady.childNodes.push(n);\n          }\n        }\n        return this.__shady.childNodes;\n      } else {\n        return childNodes(this);\n      }\n    },\n    configurable: true\n  },\n\n  firstChild: generateSimpleDescriptor('firstChild'),\n\n  lastChild: generateSimpleDescriptor('lastChild'),\n\n  textContent: {\n    get() {\n      if (hasProperty(this, 'firstChild')) {\n        let tc = [];\n        for (let i = 0, cn = this.childNodes, c; (c = cn[i]); i++) {\n          if (c.nodeType !== Node.COMMENT_NODE) {\n            tc.push(c.textContent);\n          }\n        }\n        return tc.join('');\n      } else {\n        return textContent(this);\n      }\n    },\n    set(text) {\n      if (this.nodeType !== Node.ELEMENT_NODE) {\n        // TODO(sorvell): can't do this if patch nodeValue.\n        this.nodeValue = text;\n      } else {\n        clearNode(this);\n        if (text) {\n          this.appendChild(document.createTextNode(text));\n        }\n      }\n    },\n    configurable: true\n  },\n\n  isConnected: {\n    get() {\n      return document.documentElement.contains(this);\n    },\n    configurable: true\n  }\n\n});\n\n// NOTE: For some reason `Text` redefines `assignedSlot`\nlet TextMixin = extend({}, NodeMixin);\nObject.defineProperties(TextMixin, {\n  assignedSlot: assignedSlotDesc\n});\n\nlet FragmentMixin = {\n\n  // TODO(sorvell): consider doing native QSA and filtering results.\n  querySelector(selector) {\n    // match selector and halt on first result.\n    let result = query(this, function(n) {\n      return matchesSelector(n, selector);\n    }, function(n) {\n      return Boolean(n);\n    })[0];\n    return result || null;\n  },\n\n  querySelectorAll(selector) {\n    return query(this, function(n) {\n      return matchesSelector(n, selector);\n    });\n  }\n\n};\n\nlet childrenDescriptor = {\n  get() {\n    if (hasProperty(this, 'firstChild')) {\n      return Array.prototype.filter.call(this.childNodes, function(n) {\n        return (n.nodeType === Node.ELEMENT_NODE);\n      });\n    } else {\n      return children(this);\n    }\n  },\n  configurable: true\n};\n\nlet domParser = new DOMParser();\n\nlet insertDOMFrom = function(target, from) {\n  let c$ = Array.from(from.childNodes);\n  for (let i=0; i < c$.length; i++) {\n    target.appendChild(c$[i]);\n  }\n};\n\nlet innerHTMLDescriptor = {\n  get() {\n    if (hasProperty(this, 'firstChild')) {\n      return getInnerHTML(this);\n    } else {\n      return innerHTML(this);\n    }\n  },\n  set(text) {\n    clearNode(this);\n    let doc = domParser.parseFromString(text, 'text/html');\n    if (doc.head) {\n      insertDOMFrom(this, doc.head);\n    }\n    if (doc.body) {\n      insertDOMFrom(this, doc.body);\n    }\n  },\n  configurable: true\n};\n\nObject.defineProperties(FragmentMixin, {\n\n  children: childrenDescriptor,\n\n  innerHTML: innerHTMLDescriptor,\n\n  firstElementChild: {\n    get() {\n      if (hasProperty(this, 'firstChild')) {\n        let n = this.firstChild;\n        while (n && n.nodeType !== Node.ELEMENT_NODE) {\n          n = n.nextSibling;\n        }\n        return n;\n      } else {\n        return firstElementChild(this);\n      }\n    },\n    configurable: true\n  },\n\n  lastElementChild: {\n    get() {\n      if (hasProperty(this, 'lastChild')) {\n        let n = this.lastChild;\n        while (n && n.nodeType !== Node.ELEMENT_NODE) {\n          n = n.previousSibling;\n        }\n        return n;\n      } else {\n        return lastElementChild(this);\n      }\n    },\n    configurable: true\n  }\n\n});\n\nlet SlotMixin = {\n  assignedNodes(options) {\n    if (this.localName === 'slot') {\n      renderRootNode(this);\n      return this.__shady ?\n        ((options && options.flatten ? this.__shady.distributedNodes :\n        this.__shady.assignedNodes) || []) :\n        [];\n    }\n  }\n};\n\nlet ElementMixin = extendAll({}, FragmentMixin, SlotMixin, {\n\n  // yay, add shadowRoot support!\n  attachShadow() {\n    return new ShadyRoot(this);\n  },\n\n  setAttribute(name, value) {\n    setAttribute$1(this, name, value);\n  },\n\n  removeAttribute(name) {\n    removeAttribute$1(this, name);\n  }\n});\n\nObject.defineProperties(ElementMixin, {\n\n  assignedSlot: assignedSlotDesc,\n\n  className: {\n    get() {\n      return this.getAttribute('class');\n    },\n    set(value) {\n      this.setAttribute('class', value);\n    },\n    configurable: true\n  },\n\n  shadowRoot: {\n    get() {\n      return this.shadyRoot;\n    },\n    set(value) {\n      this.shadyRoot = value;\n    },\n    configurable: true\n  },\n\n  nextElementSibling: {\n    get() {\n      if (hasProperty(this, 'nextSibling')) {\n        let n = this.nextSibling;\n        while (n && n.nodeType !== Node.ELEMENT_NODE) {\n          n = n.nextSibling;\n        }\n        return n;\n      } else {\n        return nextElementSibling(this);\n      }\n    },\n    configurable: true\n  },\n\n  previousElementSibling: {\n    get() {\n      if (hasProperty(this, 'previousSibling')) {\n        let n = this.previousSibling;\n        while (n && n.nodeType !== Node.ELEMENT_NODE) {\n          n = n.previousSibling;\n        }\n        return n;\n      } else {\n        return previousElementSibling(this);\n      }\n    },\n    configurable: true\n  },\n\n  slot: {\n    get() {\n      return this.getAttribute('slot');\n    },\n    set(value) {\n      this.setAttribute('slot', value);\n    },\n    configurable: true\n  }\n\n});\n\nlet HTMLElementMixin = {};\n\nObject.defineProperties(HTMLElementMixin, {\n\n  children: childrenDescriptor,\n\n  innerHTML: innerHTMLDescriptor\n\n});\n\nlet ActiveElementMixin = {};\nObject.defineProperties(ActiveElementMixin, {\n  activeElement: activeElementDescriptor\n});\n\nlet UnderActiveElementMixin = {};\nObject.defineProperties(UnderActiveElementMixin, {\n  _activeElement: activeElementDescriptor\n});\n\nlet Mixins = {\n\n  Node: NodeMixin,\n\n  Fragment: FragmentMixin,\n\n  Text: TextMixin,\n\n  Slot: SlotMixin,\n\n  Element: ElementMixin,\n\n  HTMLElement: HTMLElementMixin,\n\n  // Note: activeElement cannot be patched on document (on some browsers)\n  Document: extendAll({}, ElementMixin,\n    UnderActiveElementMixin, ActiveElementMixin)\n};\n\nlet patchProto = function(proto, mixin$$1, ifExists) {\n  proto.__nativeProps = Object.create(proto.__nativeProps || {});\n  let n$ = Object.getOwnPropertyNames(mixin$$1);\n  for (let i=0, n; (i<n$.length) && (n=n$[i]); i++) {\n    let sd = Object.getOwnPropertyDescriptor(proto, n);\n    if (sd) {\n      if (!sd.configurable) {\n        window.console.warn('Could not patch', n, 'on', proto);\n        return;\n      }\n      proto.__nativeProps[n] = sd;\n    }\n    if (!ifExists || (sd && sd.configurable)) {\n      let md = Object.getOwnPropertyDescriptor(mixin$$1, n);\n      Object.defineProperty(proto, n, md);\n    }\n  }\n};\n\nlet getComposedInnerHTML = function(node) {\n  return getInnerHTML(node, (n) => childNodes(n));\n};\n\nlet getComposedChildNodes = function(node) {\n  return childNodes(node);\n};\n\n/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/**\n * Patches elements that interacts with ShadyDOM\n * such that tree traversal and mutation apis act like they would under\n * ShadowDOM.\n *\n * This import enables seemless interaction with ShadyDOM powered\n * custom elements, enabling better interoperation with 3rd party code,\n * libraries, and frameworks that use DOM tree manipulation apis.\n */\n\nif (settings.inUse) {\n\n  window.ShadyDOM = {\n    // TODO(sorvell): remove when Polymer does not depend on this.\n    inUse: settings.inUse,\n    // TODO(sorvell): remove when Polymer does not depend on this.\n    patch: function(node) { return node; },\n    getComposedInnerHTML: getComposedInnerHTML,\n    getComposedChildNodes: getComposedChildNodes,\n    isShadyRoot: isShadyRoot,\n    // TODO(sorvell): exposed for testing only, worth it?\n    enqueue: enqueue,\n    flush: flush,\n    settings: settings,\n    filterMutations: filterMutations,\n    observeChildren: observeChildren,\n    unobserveChildren: unobserveChildren,\n    nativeMethods: nativeMethods\n  };\n\n  Event = PatchedEvent;\n  CustomEvent = PatchedCustomEvent;\n  MouseEvent = PatchedMouseEvent;\n  activateFocusEventOverrides();\n\n  patchProto(Node.prototype, Mixins.Node);\n  patchProto(Text.prototype, Mixins.Text);\n  patchProto(DocumentFragment.prototype, Mixins.Fragment);\n  patchProto(Element.prototype, Mixins.Element);\n  let he = (window.customElements && customElements.nativeHTMLElement) ||\n    HTMLElement;\n  patchProto(he.prototype, Mixins.HTMLElement, true);\n  patchProto(Document.prototype, Mixins.Document);\n  if (window.HTMLSlotElement) {\n    patchProto(HTMLSlotElement.prototype, Mixins.Slot);\n  }\n\n}\n\n}());\n"]}